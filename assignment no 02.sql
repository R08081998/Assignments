CREATE DATABASE ASSIGNMENT_02;
------QUE 01------

CREATE TABLE SRC_USER_DETAILS
( SRC_USER_ID INT,
 SR_USER_NAME VARCHAR (50),
SRC_USER_ADDRESS VARCHAR (90),
SRC_USER_CONTACT_DETTAILS NUMERIC (12)
);

INSERT INTO SRC_USER_DETAILS (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (101,'KUMAR','PUNE',9862534512);
INSERT INTO SRC_USER_DETAILS (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (102,'ANKIT','MUMBAI',9965327845);
INSERT INTO SRC_USER_DETAILS (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (105,'RAMESH','DELHI',8798655412);

SELECT*FROM SRC_USER_DETAILS;

CREATE TABLE TGT_SRC_USER_DETAILS
(TGT_SRC_USER_ID INT,
 TGT_SR_USER_NAME VARCHAR (50),
TGT_SRC_USER_ADDRESS VARCHAR (90),
TGT_SRC_USER_CONTACT_DETTAILS NUMERIC (12)
);
SELECT*FROM TGT_SRC_USER_DETAILS;

MERGE INTO TGT_SRC_USER_DETAILS
USING SRC_USER_DETAILS
ON (SRC_USER_ID=TGT_SRC_USER_ID)
WHEN MATCHED THEN
UPDATE SET TGT_SRC_USER_ID=SRC_USER_ID,TGT_SR_USER_NAME=SR_USER_NAME, TGT_SRC_USER_ADDRESS=SRC_USER_ADDRESS,TGT_SRC_USER_CONTACT_DETTAILS=SRC_USER_CONTACT_DETTAILS
WHEN NOT MATCHED THEN
INSERT (TGT_SRC_USER_ID,TGT_SR_USER_NAME,TGT_SRC_USER_ADDRESS,TGT_SRC_USER_CONTACT_DETTAILS)
VALUES (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS);

/*DROP TABLE TGT_SRC_USER_DETAILS;*/

---------QUE 2------------

/*2.List out the type of constraint in SQL Server?*

ANS constraint ARE THE BUSINESS RULE WHICH ALLOW USE TO MAINTAIN PROPER DATA IN INSIDE THE TABLE.
      TYPES OF SQL constraint.
	  1 NOT NULL 
	              WE CANT INSERT THE NULL VALUE IN COLUMN,COLUMN CAN NOT HAVE NULL VALUE

	2	UNIOUE KEY =CANT INSERT IN DUPLICATE VALUE , WE CAN INSERT ONLY ONE NULL VALUE, WE CAN CREATE MULTIPAL UNIQUE KEY,
	                 IN THIS CONSTRAINT VALUE IN COLUMN MUST BE UNIQUE

					 3 PRIMARY KEY =WE CAN INSERT NULL VALUE , WE CAN INSER IN DUPICATE VALUE ,WE CAN CREATE ONLY ONE PRIMARY KEY,
					 IN THI CONSTRAINT UNIQUE IDENTIFY EACH ROW IN TABLE

					 4 FOREIGN KEY= The FOREIGN KEY constraint is used to prevent actions that would destroy links between tables,

					                 A FOREIGN KEY is a field in one table, that refers to the PRIMARY KEY in another table.
									 The table with the foreign key is called the child table,
									 and the table with the primary key is called the referenced table
                      5 CHECK=       IN THIS CONSTRAINT HELP TO VALIDATE THE VALUE COLUMN TO MEET A PARTICULAR CONDITION,
					  5 DEFAULT=    IN THIS CONSTRAINT SPECIFIC DEFAULT VALUE OF THRE COLUMN NO VALUE SPECIFIED BY USER.*/

	
--------QUE 3------

/*---PRIMARY KEY  1.In this constraint aloow the unique identify each row or recored in data base table 
                2.help to unique identify each row in data base table 
				3. dont no allow the null value 
				4.in table only one primary key
-----UNIQUE KEY 1. IN THIS CONSTRAINT DONT ALLOW SAME VALUE 
                2. avoid the two record having from identical value in column
				3.allow only one null value
				4. there is multipal unique value*/
---------QUE 4----

DROP TABLE SRC_USER_DETAILS_Q04;

SELECT * fROM SRC_USER_DETAILS_Q04;

SELECT*INTO SRC_USER_DETAILS_Q04 FROM SRC_USER_DETAILS WHERE 1=8;

INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (101,'KUMAR','PUNE',9862534512);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (105,'ANKIT','MUMBAI',9965327845);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (105,'RAMESH','DELHI',8798655412);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (101,'MOHAN','PUNE',9862534512);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (102,'ANKIT','MUMBAI',9965327845);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (105,'SUDHIR','DELHI',8798655412);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (101,'HARI','PUNE',9862534512);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (102,'ABHILASH','MUMBAI',9965327845);
INSERT INTO SRC_USER_DETAILS_Q04 (SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
VALUES (105,'RAMESH','DELHI',8798655412);

SELECT * fROM SRC_USER_DETAILS_Q04;

SELECT DISTINCT SRC_USER_ID FROM SRC_USER_DETAILS_Q04;
SELECT DISTINCT SRC_USER_ID,SR_USER_NAME FROM SRC_USER_DETAILS_Q04;
SELECT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SRC_USER_ID;

SELECT SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SRC_USER_ID,SR_USER_NAME;

SELECT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SR_USER_NAME;

SELECT SRC_USER_ID,SR_USER_NAME FROM SRC_USER_DETAILS_Q04 ORDER BY SR_USER_NAME, SRC_USER_ID ;

SELECT SRC_USER_ID,SR_USER_NAME FROM SRC_USER_DETAILS_Q04 ORDER BY SR_USER_NAME, SRC_USER_ADDRESS ;
--SELECT SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS FROM SRC_USER_DETAILS_Q04 ORDER BY SR_USER_NAME, SRC_USER_ADDRESS ;


SELECT DISTINCT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SRC_USER_ID,SR_USER_NAME;

SELECT DISTINCT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SR_USER_NAME;

SELECT DISTINCT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SRC_USER_CONTACT_DETTAILS desc;

SELECT DISTINCT SRC_USER_ID, SR_USER_NAME, SRC_USER_ADDRESS, SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS_Q04 ORDER BY SRC_USER_CONTACT_DETTAILS desc, SR_USER_NAME asc;

------QUE 5-------
CREATE TABLE TGT_USER_DETAILS_05
(TGT_USER_ID INT PRIMARY KEY,
 TGT_USER_NAME VARCHAR (50),
TGT_USER_ADDRESS VARCHAR (90),
TGT_USER_CONTACT_DETTAILS NUMERIC (12)
);

INSERT INTO TGT_USER_DETAILS_05 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (101,'RANJEET','HINGOLI',9865322154);
INSERT INTO TGT_USER_DETAILS_05 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (102,'NIRAJ','MURUD',8788241372);
INSERT INTO TGT_USER_DETAILS_05 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (103,'BALAJI','SOLAPUR',5689745232);
INSERT INTO TGT_USER_DETAILS_05 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (104,'RAVI','MALGAV',8523647912);


SELECT*FROM TGT_USER_DETAILS_05;

-------QUE 06-----
CREATE TABLE TGT_USER_DETAILS_1_06
(TGT_USER_ID INT ,
 TGT_USER_NAME VARCHAR(60),
TGT_USER_ADDRESS VARCHAR (90),
TGT_USER_CONTACT_DETTAILS NUMERIC (12)
PRIMARY KEY (TGT_USER_ID,TGT_USER_NAME)
);
SELECT*FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE TABLE_NAME LIKE 'TGT_USER_DETAILS_1_06'

INSERT INTO TGT_USER_DETAILS_1_06 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (101,'RANJEET','HINGOLI',9865322154);
INSERT INTO TGT_USER_DETAILS_1_06 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (102,'NIRAJ','MURUD',8788241372);
INSERT INTO TGT_USER_DETAILS_1_06 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (103,'BALAJI','SOLAPUR',5689745232);
INSERT INTO TGT_USER_DETAILS_1_06 (TGT_USER_ID,TGT_USER_NAME,TGT_USER_ADDRESS,TGT_USER_CONTACT_DETTAILS)
VALUES (104,'RAVI','MALGAV',8523647912);

SELECT*FROM TGT_USER_DETAILS_1_06;

-----QUE 07-----

SELECT DISTINCT TGT_USER_ID FROM TGT_USER_DETAILS_1_06;
SELECT DISTINCT TGT_USER_NAME FROM TGT_USER_DETAILS_1_06;
SELECT DISTINCT TGT_USER_NAME,TGT_USER_ADDRESS FROM TGT_USER_DETAILS_1_06;
SELECT DISTINCT TGT_USER_CONTACT_DETTAILS FROM TGT_USER_DETAILS_1_06;

-----QUE 08---------
SELECT TOP 3*FROM TGT_USER_DETAILS_1_06;

------QUE 09------
CREATE TABLE TGT_USER_DETAILS_0555
(TGT_USER_ID INT,
 TGT_USER_NAME VARCHAR (50),
TGT_USER_ADDRESS VARCHAR (90),
TGT_USER_CONTACT_DETTAILS NUMERIC (12)
);
SELECT*FROM TGT_USER_DETAILS_0555;

ALTER TABLE TGT_USER_DETAILS_0555
ADD PRIMARY KEY (TGT_USER_ID);
DROP TABLE TGT_USER_DETAILS_0555;

ALTER TABLE TGT_USER_DETAILS_0555 alter column TGT_USER_ID int NOT NULL;
SELECT*FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE

-------QUE 10-----

composite primary key is define as combination of multipal column 
A composite key cannot be null.

/*------que 11-----
UNIQUE KEY                                                                 PRIMARY KEY
1. IN THIS CONSTRAINT DONT ALLOW SAME VALUE                                  1.In this constraint aloow the unique identify each row or recored in data base table
2. avoid the two record having from identical value in column                2.help to unique identify each row in data base table
3. allow only one null value                                                 3.dont no allow the null value 
4. there is multipal unique value                                            4.in table only one primary key*/

--------QUE 12-----------

CREATE TABLE UPSKILL_GRP_D
( MEB_ID INT NOT NULL,
FIRST_NAME VARCHAR (10),
LAST_NAME VARCHAR (10),
AGE INT,
CHECK (AGE>20) );

INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (01,'MAYUR','TAMBOLI',21);
INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (02,'SHASHIKANT','GALANGE',31);
INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (03,'DEEPAK','PATIL',35);
INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (03,'SANCHAY','PAWAR',24);
INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (04,'NIRMALA','DIVTE',30);
INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (05,'ANUSHKA','SHETTY',37);
---INSERT INTO UPSKILL_GRP_D(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
----VALUES (06,'MERA','PATIL',20);

SELECT*FROM UPSKILL_GRP_D;

-------QUE 13----
/*The DEFAULT constraint is used to set a default value for a column.*/
CREATE TABLE UPSKILL_GRP_DE
( MEB_ID INT NOT NULL,
FIRST_NAME VARCHAR (10),
LAST_NAME VARCHAR (10),
AGE INT  DEFAULT 0);


INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME)
VALUES (01,'MAYUR','TAMBOLI');
INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (02,'SHASHIKANT','GALANGE',31);
INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (03,'DEEPAK','PATIL',35);
INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME)
VALUES (03,'SANCHAY','PAWAR');
INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (04,'NIRMALA','DIVTE',30);
INSERT INTO UPSKILL_GRP_DE(MEB_ID,FIRST_NAME,LAST_NAME,AGE)
VALUES (05,'ANUSHKA','SHETTY',37);
SELECT*FROM UPSKILL_GRP_DE;


-------QUE  14-------------
/*The foreign key constraint is used to prevent actions that would destroy links between tables.
----- IN FOREIGN KEY NULL AND DUPLICATE VALUE BE ADDED
IN THIS WE CAN NOT INSERT IN ORDER TABLE WITH THIS ID NOT PRESENT IN CUST TABLE
WE CAN NOT DELETE THE DATA CUST ID PRESENT IN ORD ID*/

CREATE TABLE CUST_TABLE
(C_ID INT PRIMARY KEY,
C_NAME VARCHAR (20),
C_ADDRESS VARCHAR(MAX),
CITY VARCHAR (30)
);

INSERT INTO CUST_TABLE (C_ID,C_NAME,C_ADDRESS,CITY)
VALUES (1,'NTR','LATIFABAD.NO 1','PUNE')
INSERT INTO CUST_TABLE (C_ID,C_NAME,C_ADDRESS,CITY)
VALUES (2,'RAM','LATIFABAD.NO 2','MUMBAI')
INSERT INTO CUST_TABLE (C_ID,C_NAME,C_ADDRESS,CITY)
VALUES (3,'ALLU','LATIFABAD.NO 3','CHENNAI')
INSERT INTO CUST_TABLE (C_ID,C_NAME,C_ADDRESS,CITY)
VALUES (4,'SUNNY','LATIFABAD.NO 4','NASHIK')
SELECT*FROM CUST_TABLE;

CREATE TABLE ORD_TABLE
(ORD_ID INT PRIMARY KEY,
ITEM VARCHAR (50),
QUNTITY INT,
PRICE_OF_1 INT,
C_ID INT FOREIGN KEY REFERENCES CUST_TABLE (C_ID)
);
INSERT INTO ORD_TABLE VALUES (111,'MOUSE',2,200,3);
INSERT INTO ORD_TABLE VALUES (222,'KEYBOARD',1,300,1);
INSERT INTO ORD_TABLE VALUES (333,'SPEAKER',3,220,4);
INSERT INTO ORD_TABLE VALUES (444,'MONITAR',5,260,2);
INSERT INTO ORD_TABLE VALUES (555,'MOBILE',3,270,2);

INSERT INTO ORD_TABLE VALUES (666,'EAREPHONE',6,210,5);

SELECT*FROM CUST_TABLE;
SELECT*FROM ORD_TABLE;
---ALTER TABLE ORD_TABLE DROP CONSTRAINT [FK__ORD_TABLE__C_ID__0A9D95DB];
-----ALTER TABLE ORD_TABLE ADD FOREIGN KEY (C_ID) REFERENCES  CUST_TABLE (C_ID);

------QUE 15-------
SELECT * INTO TGT_SRC_USER_DETAILS_123 FROM SRC_USER_DETAILS WHERE 1=2;
SELECT * FROM TGT_SRC_USER_DETAILS_123;
SELECT * INTO TGT_SRC_USER_DETAILS_1234 FROM SRC_USER_DETAILS WHERE 1=2;
SELECT*FROM TGT_SRC_USER_DETAILS_1234;

---QUE 16-----
INSERT TGT_SRC_USER_DETAILS_123(SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS)
SELECT SRC_USER_ID,SR_USER_NAME,SRC_USER_ADDRESS,SRC_USER_CONTACT_DETTAILS FROM SRC_USER_DETAILS;
SELECT*FROM TGT_SRC_USER_DETAILS_123;
----QUE 17------
SELECT GETDATE ();
SELECT CURRENT_TIMESTAMP ;

-----QUE 18------
SELECT CURRENT_TIMESTAMP;

select CONVERT (varchar(10), getdate(), 103) AS [DD/MM/YYYY]

---QUE 19-----

SELECT * fROM SRC_USER_DETAILS_Q04;

SELECT * fROM SRC_USER_DETAILS_Q04 WHERE SR_USER_NAME IN ('KUMAR','ANKIT');
SELECT * fROM SRC_USER_DETAILS_Q04 WHERE SR_USER_NAME NOT IN ('KUMAR','ANKIT');

--false otherwise for IN and true if the value is not in the list and false otherwise for NOT IN 

----QUE 20----
CREATE TABLE ALL_NAME 
(FIRST_NAME VARCHAR (10),
LAST_NAME VARCHAR (10)
);
INSERT INTO ALL_NAME (FIRST_NAME,LAST_NAME)
VALUES ('RAHUL','PATIL');
INSERT INTO ALL_NAME (FIRST_NAME,LAST_NAME)
VALUES ('RANJEET','NARVEKAR');
INSERT INTO ALL_NAME (FIRST_NAME,LAST_NAME)
VALUES ('RAVI','KAMBALE');
INSERT INTO ALL_NAME (FIRST_NAME,LAST_NAME)
VALUES ('VIJAY','PATIL');
INSERT INTO ALL_NAME (FIRST_NAME,LAST_NAME)
VALUES ('BALAJI','MULE');

ALTER TABLE ALL_NAME ADD FULLNAME VARCHAR (20);
UPDATE ALL_NAME SET FULLNAME=CONCAT( FIRST_NAME,'  ', LAST_NAME);

SELECT*FROM ALL_NAME;
SELECT FIRST_NAME, LAST_NAME, CONCAT( FIRST_NAME,' ', LAST_NAME)  AS FULL_NAME FROM ALL_NAME;
SELECT CONCAT( FIRST_NAME,'  ', LAST_NAME)  AS FULL_NAME FROM ALL_NAME;
SELECT CONCAT( FIRST_NAME, '  ', LAST_NAME)  AS FULL_NAME FROM ALL_NAME;
